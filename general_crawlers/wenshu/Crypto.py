# __author__ = "zok" 362416272@qq.com
# Date: 2020/7/24 Python:3.7

import pyDes
import base64


class TripleDesUtils:

    def encryption(self, data: str, key, iv) -> str:
        """3des 加密
        """
        _encryption_result = pyDes.triple_des(key, pyDes.CBC, iv, None, pyDes.PAD_PKCS5).encrypt(data)
        _encryption_result = self._base64encode(_encryption_result).decode()
        return _encryption_result

    def decrypt(self, data: str, key, iv) -> str:
        """3des 解密
        """
        data = self._base64decode(data)
        _decrypt_result = pyDes.triple_des(key, pyDes.CBC, iv, None, pyDes.PAD_PKCS5).decrypt(data).decode('utf-8')
        return _decrypt_result

    @staticmethod
    def _base64encode(data):
        try:
            _b64encode_result = base64.b64encode(data)
        except Exception as e:
            raise Exception(f"base64 encode error:{e}")
        return _b64encode_result

    @staticmethod
    def _base64decode(data):
        try:
            _b64decode_result = base64.b64decode(data)
        except Exception as e:
            raise Exception(f"base64 decode error:{e}")
        return _b64decode_result


des3 = TripleDesUtils()


if __name__ == "__main__":
    _test_data = '1595553133358'
    _key = 'fmgKRc4aLmgTbXzcm9PNziI8'
    _iv = '20200724'
    result = des3.encryption(_test_data, _key, _iv)
    print(f"加密结果: {result}")

    _test_data = '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'
    _key = 'wsqazlrjlR19PFERA80oiIie'
    _iv = '20200724'
    result2 = des3.decrypt(_test_data, _key, _iv)
    print(f"解密结果: {result2}")

